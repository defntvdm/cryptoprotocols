Реализация протокола передачи бита на хранение

Протокол позволяет передать информацию, но узнать её получатель сможет только тогда, когда отправитель позволит.

1) Алиса генерируется большие цепочки байт R1 и R2. Последний бит R2 и есть секретный (достигается R2[-1] | 1 или R2[-1] & 0xfe)
2) Алиса считает хэш от R1+R2 (конкатенация)
3) Алиса передаёт R1 и хэш Бобу.
4) Алиса решает раскрыть секрет и отправляет R2
5) Боб считает хэш от полученных R1 и R2, сверяет с полученным от Алисы хэшом

Ключи:
    -s - секретный бит 1 или 0
    -с - подправить 1 байт хэша на произвольный

По хорошему надо игру писать, но игровую логику писать долговато. Поэтому просто примерное описание.

Игра техасский холдем покер.
Мы честнейший диллер.
Раздаём карты и вместе с каждой картой её R1 и хэш.
В конце к каждой карте раздаём R2. За счёт чего можно выявить жулика, который вполне вероятно мог подменить карту.
